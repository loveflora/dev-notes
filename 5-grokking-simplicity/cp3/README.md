# CP 3. 액션과 계산, 데이터의 차이를 알기

## 1. 액션, 계산, 데이터 구분하기

### 1) 액션

<!--
- 실행 시점과 횟수에 의존
- 사이드 이펙트, 사이드 이펙트가 있는 함수, 비순수 함수 라고도 함
- 예) 이메일 보내기, 데이터베이스 읽기

### 계산

- 입력으로 출력을 계산
- 순수 함수, 수학 함수라고도 함
- 예) 최댓값 찾기, 이메일 주소 유효성 검증

참조 투명(referentially transparent)

- `2 + 3` 코드에서 `+`는 계산이기 때문에 `2 + 3`의 결과는 항상 `5`
- `2 + 3` 코드를 `5`라는 결과값으로 바꿔도 프로그램이 달라지지 않음

### 데이터

- 이벤트에 대한 사실
- 예) 유저가 입력한 이메일 주소

### 액션, 계산, 데이터 구분

모든 개발 과정에서 액션, 계산, 데이터를 구분할 수 있다

- 개발 전: 문제 정의 과정
  - 꼭 액션으로 처리해야 하는지?, 데이터로 처리할 수는 없는지
- 개발 중
  - 최대한 액션에서 계산 뽑아냄
  - 계산에서 데이터를 분리하려고 노력
- 개발 후
  - 숨은 액션 찾고 리팩토링

### 프로그램 흐름

- DB에서 구독자 리스트 쿼리: A
  - 구독자 리스트: D
- DB에서 쿠폰 리스트 쿼리: A
  - 쿠폰 리스트: D
- 보낼 이메일 리스트 만들기: C
  - 이메일 리스트: D
- 이메일 리스트대로 각각 쿠폰 전송: A

### 보낼 이메일 리스트 만들기 세분화

이메일 리스트 만들기 계산

- 보낼 이메일 리스트를 만들기 위해 구독자 리스트, 쿠폰 리스트 2개의 입력값 필요
- 계산 결과: 이메일 리스트

이메일 리스트 만들기 세분화

- best 쿠폰 이메일 리스트 만들기: C
  - 쿠폰 리스트(D)에서 best 쿠폰 선택하기: C
    - best 쿠폰 리스트: D1
  - 구독자 리스트에서 rec_count >= 10인 구독자 선택하기: C
    - rec_count >= 10인 구독자 리스트 : D2
- good 쿠폰 이메일 리스트 만들기: C
  - 쿠폰 리스트(D)에서 good 쿠폰 선택하기: C
    - good 쿠폰 리스트: D3
  - 구독자 리스트에서 rec_count < 10인 구독자 선택하기:
    - rec_count < 10인 구독자 리스트 : D4
- D1, D2, D3, D4 데이터들을 바탕으로 이메일 리스트 반환

세분화하는 것의 장점: 액션에 비해 계산은 테스트하기 쉬움

### 쿠폰 보내는 과정 구현

`coupon.ts` 확인 -->
